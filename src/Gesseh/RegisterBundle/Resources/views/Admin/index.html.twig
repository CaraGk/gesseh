{% extends 'GessehCoreBundle::layout.html.twig' %}

{% block title %}{{ parent() }} - Adhérents{% endblock %}

{% block titlecontent %}
    Adhérents en cours {% if limit %}(validés){% endif %}
{% endblock %}

{% block actionscontent %}
    {% if limit is not null %}
        <li class="field"><a href="{{ path('GRegister_AIndex') }}"><button type="button">Toutes adhésions</button></a></li>
    {% else %}
        <li class="field"><a href="{{ path('GRegister_AIndex', {'limit': true}) }}"><button type="button">Adhésions validées</button></a></li>
    {% endif %}
    <li class="field"><a href="{{ path('GRegister_AExport') }}"><button type="button">Exporter (xls)</button></a></li>
{% endblock %}

{% block content %}
    {{ form(filter) }}
    <ul>
    {% for membership in memberships %}
        <li class="entity student">
            <div class="field">{{ membership.student }}</div>
            {% if membership.payedOn is not null %}
                <div class="field">Paiement par {{ membership.readableMethod|lower }} effectué ({{ membership.payedOn|date('d/m/Y') }})</div>
            {% else %}
                <div class="field">
                    <a href="{{ path('GRegister_AValidate', {'id': membership.id, 'userid': membership.student.user.id, view: 'index'}) }}" title="Valider la réception du paiement pour cette adhésion">Valider</a>
                    <a href="{{ path('GRegister_ADelete', {'id': membership.id, 'userid': membership.student.user.id, 'view': 'index'}) }}" title="Supprimer cette adhésion">Supprimer</a>
                </div>
            {% endif %}
            <div class="field"><a href="{{ path('GRegister_UIndex', {'userid': membership.student.user.id}) }}" title="Afficher le détail des adhésions de l'étudiant">Détail</a></div>
        </li>
    {% else %}
        <li>Aucune adhésion enregistrée.</li>
    {% endfor %}
    </ul>
{% endblock %}
