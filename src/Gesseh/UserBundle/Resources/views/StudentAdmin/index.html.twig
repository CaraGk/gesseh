{% extends 'GessehCoreBundle::layout.html.twig' %}

{% block title %}{{ parent() }} - Étudiants ({{ students_count }}){% endblock %}

{% block titlecontent %}
    Étudiants ({{ students_count }})
    <span><a href="{{ path('GUser_SANew') }}#student_new" title="Ajouter un nouvel étudiant"><img src="{{ asset('bundles/gessehcore/images/Add.png') }}" alt="Ajouter" /></a></span>
{% endblock %}

{% block actionscontent %}
    <li class="field">
      <form>
          <label for="search">Nom :</label>
          <input type="text" id="search" name="search" value="{{ search }}" />
          <button type="submit"><img src="{{ asset('bundles/gessehcore/images/Search.png') }}" alt="Rechercher" /></button>
      </form>
    </li>
    <li class="field"><a href="{{ path('GUser_SAImport') }}" title="Importer une promotion d'internes"><button type="button">Importer une promo</button></a></li>
    <li class="field"><a href="{{ path('GUser_GAUpdateNext') }}" title="Passer tous les étudiants dans la promotion supérieure" class="confirm" confirm="Attention ! Cette opération va passer tous les internes dans la promotion suivante ! Êtes-vous sûrs de vouloir continuer ?"><button type="button">Changer de promo</button></a></li>
{% endblock %}

{% block content %}
    {% for student in students %}
        <li class="entity student">
            <div class="field">
                <div class="contact">
                    <div class="entity_title student_name">{{ student.surname }} {{ student.name }}</div>
                    <div class="entity_item student_email"><a href="mailto:{{ student.user.email }}" title="Envoyer un email à {{ student.name }} {{ student.surname }}">{{ student.user.email }}</a></div>
                    <div class="entity_item student_phone"><a href="tel:{{ student.phone }}" title="Téléphoner à {{ student.name }} {{ student.surname }}">{{ student.phone }}</a></div>
                </div>
                <div class="studies">
                    <div class="entity_item student_grade">{{ student.grade }}</div>
                    {% if kparam('simul_active') == true %}
                        <div class="entity_item student_rank">Classement ECN : {{ student.ranking }} | Année ECN : {{ student.graduate }}</div>
                    {% endif %}
                </div>
            </div>
            <ul class="actions">
                <li class="action"><a href="{{ path('GUser_SAEdit', {'id': student.id}) }}?{{ app.request.queryString }}#student_{{ student.id }}" title="Modifier l'étudiant '{{ student }}'" class="edit"><img src="{{ asset('bundles/gessehcore/images/Pencil_2.png') }}" alt="Modifier" /></a></li>
                <li class="action"><a href="{{ path('GUser_SADelete', {'id': student.id}) }}" title="Supprimer l'étudiant '{{ student }}'" class="confirm delete" confirm="Attention, vous allez supprimer l'étudiant et toutes les informations s'y rapportant ! Voulez-vous continuer ?"><img src="{{ asset('bundles/gessehcore/images/Trash_Delete.png') }}" alt="Supprimer" /></a></li>
                {% if 'ROLE_ADMIN' in student.user.roles %}
                    <li class="action"><a href="{{ path('GUser_SADemote', {'id': student.id}) }}?{{ app.request.queryString }}#student_{{ student.id }}" title="Démettre l'étudiant '{{ student }}'"><img src="{{ asset('bundles/gessehcore/images/Fav.png') }}" alt="Démettre" /></a></li>
                {% else %}
                    <li class="action"><a href="{{ path('GUser_SAPromote', {'id': student.id}) }}?{{ app.request.queryString }}#student_{{ student.id }}" title="Promouvoir l'étudiant '{{ student }}'"><img src="{{ asset('bundles/gessehcore/images/Fav_Empty.png') }}" alt="Promouvoir" /></a></li>
                {% endif %}
                <li class="action"><a href="{{ path('GCore_PAPlacementIndex', {'limit': {'type': 's.id', 'value': student.id, 'description': student.surname ~ ' ' ~ student.name}}) }}" title="Afficher les stages de l'étudiant '{{ student }}'"><img src="{{ asset('bundles/gessehcore/images/Blocknotes.png') }}" alt="Stages" /></a></li>
            </ul>
        </li>
    {% endfor %}
    <div class="pagination">{{ knp_pagination_render(students) }}</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/gessehcore/js/confirm.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/gessehcore/js/actions.js') }}" type="text/javascript"></script>
{% endblock %}
