{% extends 'GessehCoreBundle::layout.html.twig' %}

{% block titlecontent %}Table de simulation{% endblock %}
{% block actionscontent %}{% include 'GessehSimulationBundle:SimulationAdmin:subMenu.html.twig' %}{% endblock %}

{% block content %}
  <table>
      <thead>
        <tr>
          <th class="small">Rang</th>
          <th>Étudiant</th>
          <th>Poste</th>
          <th class="small">Vœux</th>
          <th class="small">Reste</th>
          <th class="actions">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for simulation in simulations %}
          <tr>
            <td class="small">{{ simulation.id }}</td>
            <td>{{ simulation.student.surname }} {{ simulation.student.name }}</td>
            {% if simulation.active %}
              {% if simulation.department %}
                <td>{{ simulation.department }}</td>
              {% else %}
                <td>Aucun choix valide</td>
              {% endif %}
            {% else %}
              <td>Ne participe pas aux simulations</td>
            {% endif %}
            <td class="small">{{ simulation.countWishes }}</td>
            <td class="small">{{ simulation.extra }}</td>
            <td class="actions">
              <ul>
                <li><a href="{{ path('GSimul_SAWish', {'id': simulation.id}) }}" title="Afficher les vœux de l'étudiant {{ simulation.student }}">Vœux</a></li>
              </ul>
            </td>
          <tr>
        {% else %}
          <tr>
            <td colspan=5>La table de simulation n'est pas générée. <a href="{{ path('GSimul_SADefine') }}" title="Cliquez pour générer la table de simulation">Générer la table</a></td>
          </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <td class="pagination" colspan=6>{{ knp_pagination_render(simulations) }}</td>
        </tr>
      </tfoot>
  </table>
    {% if simulations is not empty %}
      <div>
        <ul>
          <li><a href="{{ path('GSimul_SASim') }}" title="Lancer l'algorithme de simulation">Lancer les simulations</a></li>
          <li><a href="{{ path('GSimul_SAPurge') }}" title="Supprimer la table de simulation (supprime TOUTES les données)" class="confirm">Supprimer la table de simulation</a></li>
          <li><a href="{{ path('GSimul_SASave') }}" title="Valider les simulation et les enregistrer dans les stages.">Valider les simulations</a></li>
        </ul>
      </div>
    {% endif %}
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script src="{{ asset('bundles/gessehcore/js/confirm.js') }}" type="text/javascript"></script>
{% endblock %}
